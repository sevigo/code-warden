=== RUN   TestValidateAndJoinPath_Security
=== RUN   TestValidateAndJoinPath_Security/valid_relative_path
=== RUN   TestValidateAndJoinPath_Security/simple_traversal_attempt
=== RUN   TestValidateAndJoinPath_Security/deep_traversal_attempt
=== RUN   TestValidateAndJoinPath_Security/current_directory_dot
--- PASS: TestValidateAndJoinPath_Security (0.00s)
    --- PASS: TestValidateAndJoinPath_Security/valid_relative_path (0.00s)
    --- PASS: TestValidateAndJoinPath_Security/simple_traversal_attempt (0.00s)
    --- PASS: TestValidateAndJoinPath_Security/deep_traversal_attempt (0.00s)
    --- PASS: TestValidateAndJoinPath_Security/current_directory_dot (0.00s)
=== RUN   TestValidateAndJoinPath_Symlinks
=== RUN   TestValidateAndJoinPath_Symlinks/symlink_traversal_(link_exists_points_out)
=== RUN   TestValidateAndJoinPath_Symlinks/lexical_traversal_with_non-existent_path
--- PASS: TestValidateAndJoinPath_Symlinks (0.00s)
    --- PASS: TestValidateAndJoinPath_Symlinks/symlink_traversal_(link_exists_points_out) (0.00s)
    --- PASS: TestValidateAndJoinPath_Symlinks/lexical_traversal_with_non-existent_path (0.00s)
=== RUN   TestGetDirectoryPath
--- PASS: TestGetDirectoryPath (0.00s)
=== RUN   TestCalculateDirectoryHash
--- PASS: TestCalculateDirectoryHash (0.00s)
=== RUN   TestExtractDocMetadata
--- PASS: TestExtractDocMetadata (0.00s)
=== RUN   TestExtractTag_Security
=== RUN   TestExtractTag_Security/simple_extraction
=== RUN   TestExtractTag_Security/no_tags
=== RUN   TestExtractTag_Security/unclosed_tag
=== RUN   TestExtractTag_Security/nested_tags_(should_return_outer_content)
=== RUN   TestExtractTag_Security/malformed_end_tag
--- PASS: TestExtractTag_Security (0.00s)
    --- PASS: TestExtractTag_Security/simple_extraction (0.00s)
    --- PASS: TestExtractTag_Security/no_tags (0.00s)
    --- PASS: TestExtractTag_Security/unclosed_tag (0.00s)
    --- PASS: TestExtractTag_Security/nested_tags_(should_return_outer_content) (0.00s)
    --- PASS: TestExtractTag_Security/malformed_end_tag (0.00s)
=== RUN   TestSanitizePath_Security
=== RUN   TestSanitizePath_Security/**`path/to/file.go`**
=== RUN   TestSanitizePath_Security/__some/path.txt__
=== RUN   TestSanitizePath_Security/"path/with/quotes"
=== RUN   TestSanitizePath_Security/path*with*stars
--- PASS: TestSanitizePath_Security (0.00s)
    --- PASS: TestSanitizePath_Security/**`path/to/file.go`** (0.00s)
    --- PASS: TestSanitizePath_Security/__some/path.txt__ (0.00s)
    --- PASS: TestSanitizePath_Security/"path/with/quotes" (0.00s)
    --- PASS: TestSanitizePath_Security/path*with*stars (0.00s)
=== RUN   TestDoS_PreambleResilience
--- PASS: TestDoS_PreambleResilience (0.00s)
=== RUN   TestParseMarkdownReview
=== RUN   TestParseMarkdownReview/Valid_XML_Review
=== RUN   TestParseMarkdownReview/Preamble-Resilient_XML
=== RUN   TestParseMarkdownReview/Dirty_XML_(Bolded_Path_and_Extra_Tags)
=== RUN   TestParseMarkdownReview/Multiple_Suggestions_and_Range
=== RUN   TestParseMarkdownReview/Indented_XML_(Pretty_Printed)
=== RUN   TestParseMarkdownReview/En_and_Em_Dashes_in_Range
=== RUN   TestParseMarkdownReview/Tags_with_whitespace
=== RUN   TestParseMarkdownReview/Legacy_Markdown_Review
=== RUN   TestParseMarkdownReview/Absolute_Path_Rejection
    parser_test.go:235: 
        	Error Trace:	C:/Users/igork/sevigo/code-warden/internal/llm/parser_test.go:235
        	Error:      	Received unexpected error:
        	            	failed to parse review: no XML found and legacy parsing yielded no results
        	Test:       	TestParseMarkdownReview/Absolute_Path_Rejection
=== RUN   TestParseMarkdownReview/Windows_Absolute_Path_Rejection
    parser_test.go:235: 
        	Error Trace:	C:/Users/igork/sevigo/code-warden/internal/llm/parser_test.go:235
        	Error:      	Received unexpected error:
        	            	failed to parse review: no XML found and legacy parsing yielded no results
        	Test:       	TestParseMarkdownReview/Windows_Absolute_Path_Rejection
=== RUN   TestParseMarkdownReview/Missing_Review_Tag
--- FAIL: TestParseMarkdownReview (0.00s)
    --- PASS: TestParseMarkdownReview/Valid_XML_Review (0.00s)
    --- PASS: TestParseMarkdownReview/Preamble-Resilient_XML (0.00s)
    --- PASS: TestParseMarkdownReview/Dirty_XML_(Bolded_Path_and_Extra_Tags) (0.00s)
    --- PASS: TestParseMarkdownReview/Multiple_Suggestions_and_Range (0.00s)
    --- PASS: TestParseMarkdownReview/Indented_XML_(Pretty_Printed) (0.00s)
    --- PASS: TestParseMarkdownReview/En_and_Em_Dashes_in_Range (0.00s)
    --- PASS: TestParseMarkdownReview/Tags_with_whitespace (0.00s)
    --- PASS: TestParseMarkdownReview/Legacy_Markdown_Review (0.00s)
    --- FAIL: TestParseMarkdownReview/Absolute_Path_Rejection (0.00s)
    --- FAIL: TestParseMarkdownReview/Windows_Absolute_Path_Rejection (0.00s)
    --- PASS: TestParseMarkdownReview/Missing_Review_Tag (0.00s)
=== RUN   TestStripMarkdownFence
=== RUN   TestStripMarkdownFence/No_fence
=== RUN   TestStripMarkdownFence/Markdown_fence
--- PASS: TestStripMarkdownFence (0.00s)
    --- PASS: TestStripMarkdownFence/No_fence (0.00s)
    --- PASS: TestStripMarkdownFence/Markdown_fence (0.00s)
=== RUN   TestPerformSingleHyDEJob_Reranking
=== RUN   TestPerformSingleHyDEJob_Reranking/Success:_Recall_20_->_Rerank_Top_5
=== RUN   TestPerformSingleHyDEJob_Reranking/Fallback:_Reranking_Fails_->_Return_Base_Recall_(Trimmed_to_5)
2026/02/13 03:15:52 WARN reranking failed, falling back error="rerank error"
=== RUN   TestPerformSingleHyDEJob_Reranking/Precision:_Recall_returns_fewer_than_TopK_->_Rerank_all
--- PASS: TestPerformSingleHyDEJob_Reranking (0.04s)
    --- PASS: TestPerformSingleHyDEJob_Reranking/Success:_Recall_20_->_Rerank_Top_5 (0.01s)
    --- PASS: TestPerformSingleHyDEJob_Reranking/Fallback:_Reranking_Fails_->_Return_Base_Recall_(Trimmed_to_5) (0.02s)
    --- PASS: TestPerformSingleHyDEJob_Reranking/Precision:_Recall_returns_fewer_than_TopK_->_Rerank_all (0.00s)
=== RUN   TestStripPatchNoise
=== RUN   TestStripPatchNoise/empty
=== RUN   TestStripPatchNoise/only_metadata
=== RUN   TestStripPatchNoise/mixed
=== RUN   TestStripPatchNoise/hyde_header_+_patch
--- PASS: TestStripPatchNoise (0.00s)
    --- PASS: TestStripPatchNoise/empty (0.00s)
    --- PASS: TestStripPatchNoise/only_metadata (0.00s)
    --- PASS: TestStripPatchNoise/mixed (0.00s)
    --- PASS: TestStripPatchNoise/hyde_header_+_patch (0.00s)
=== RUN   TestPreFilterBM25
=== RUN   TestPreFilterBM25/topK_>=_len
=== RUN   TestPreFilterBM25/topK_<_len
=== RUN   TestPreFilterBM25/empty_query
=== RUN   TestPreFilterBM25/empty_docs
--- PASS: TestPreFilterBM25 (0.00s)
    --- PASS: TestPreFilterBM25/topK_>=_len (0.00s)
    --- PASS: TestPreFilterBM25/topK_<_len (0.00s)
    --- PASS: TestPreFilterBM25/empty_query (0.00s)
    --- PASS: TestPreFilterBM25/empty_docs (0.00s)
=== RUN   TestSanitizeModelForFilename
=== RUN   TestSanitizeModelForFilename/kimi-k2.5:cloud
=== RUN   TestSanitizeModelForFilename/deepseek/v3
=== RUN   TestSanitizeModelForFilename/suspicious..name
=== RUN   TestSanitizeModelForFilename/<invalid>
=== RUN   TestSanitizeModelForFilename/COM1
=== RUN   TestSanitizeModelForFilename/CollisionResistance
--- PASS: TestSanitizeModelForFilename (0.00s)
    --- PASS: TestSanitizeModelForFilename/kimi-k2.5:cloud (0.00s)
    --- PASS: TestSanitizeModelForFilename/deepseek/v3 (0.00s)
    --- PASS: TestSanitizeModelForFilename/suspicious..name (0.00s)
    --- PASS: TestSanitizeModelForFilename/<invalid> (0.00s)
    --- PASS: TestSanitizeModelForFilename/COM1 (0.00s)
    --- PASS: TestSanitizeModelForFilename/CollisionResistance (0.00s)
=== RUN   TestProcessRelatedSnippet_Concurrency
--- PASS: TestProcessRelatedSnippet_Concurrency (0.00s)
FAIL
FAIL	github.com/sevigo/code-warden/internal/llm	0.141s
FAIL
